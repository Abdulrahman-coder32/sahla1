<div class="profile-container">
  <div class="profile-card">
    <div class="profile-header">
      <h1>الملف الشخصي</h1>
      <p>إدارة بياناتك الشخصية بسهولة وأمان</p>
    </div>

    <div class="profile-content">
      <div *ngIf="loading" class="flex justify-center py-24">
        <div class="w-20 h-20 border-6 border-indigo-600 border-t-transparent rounded-full animate-spin"></div>
      </div>

      <div *ngIf="!loading" class="space-y-16">
        <!-- Toast -->
        <div *ngIf="message" class="fixed top-24 left-1/2 -translate-x-1/2 z-50 px-10 py-5 rounded-2xl shadow-2xl text-white font-bold text-xl"
             [ngClass]="message.type === 'success' ? 'bg-green-600' : 'bg-red-600'">
          {{ message.text }}
        </div>

        <!-- Avatar -->
        <div class="profile-avatar-wrapper">
          <div class="relative inline-block">
            <img [src]="previewUrl || getProfileImageUrl()" alt="صورة الملف الشخصي" class="profile-avatar">

            <label class="profile-camera-btn" [class.hidden]="!isEditing">
              <i class="fas fa-camera"></i>
              <input type="file" accept="image/*" (change)="onFileSelected($event)" class="hidden">
            </label>
          </div>

          <h2 class="profile-name">{{ user.name || 'المستخدم' }}</h2>
          <p class="profile-role">
            <i class="fas fa-user-tag"></i>
            {{ user.role === 'job_seeker' ? 'باحث عن عمل' : 'صاحب عمل' }}
          </p>
          <p class="profile-email">
            <i class="fas fa-envelope"></i> {{ user.email }}
          </p>
        </div>

        <!-- Info Card -->
        <div class="profile-info-card">
          <h3 class="profile-info-title">
            <i class="fas fa-info-circle"></i>
            معلومات الحساب
          </h3>

          <div class="profile-form-grid">
            <div>
              <label class="profile-label">الاسم الكامل</label>
              <input [(ngModel)]="user.name" [disabled]="!isEditing" class="profile-input">
            </div>

            <div>
              <label class="profile-label">رقم الهاتف</label>
              <input [(ngModel)]="user.phone" [disabled]="!isEditing" placeholder="01xxxxxxxxx" class="profile-input">
            </div>

            <div>
              <label class="profile-label">نبذة تعريفية (اختياري)</label>
              <textarea [(ngModel)]="user.bio" [disabled]="!isEditing" rows="6" class="profile-input profile-textarea" placeholder="اكتب نبذة قصيرة عن نفسك..."></textarea>
            </div>
          </div>
        </div>

        <!-- Action Buttons -->
        <div class="profile-actions">
          <button *ngIf="!isEditing" (click)="toggleEdit()" class="profile-btn profile-btn-edit">
            <i class="fas fa-edit profile-btn-icon"></i>
            تعديل الملف الشخصي
          </button>

          <div *ngIf="isEditing" class="flex flex-col sm:flex-row gap-8 w-full max-w-4xl">
            <button (click)="saveProfile()" [disabled]="saving" class="profile-btn profile-btn-save">
              <i class="fas fa-save profile-btn-icon" *ngIf="!saving"></i>
              <span *ngIf="saving">جاري الحفظ...</span>
              <span *ngIf="!saving">حفظ التغييرات</span>
            </button>

            <button (click)="cancelEdit()" class="profile-btn profile-btn-cancel">
              <i class="fas fa-times profile-btn-icon"></i>
              إلغاء
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
