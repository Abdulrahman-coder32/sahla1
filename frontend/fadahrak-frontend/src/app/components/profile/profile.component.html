<div class="min-h-screen bg-gray-100 py-8 px-4">
  <div class="max-w-2xl mx-auto bg-white rounded-2xl shadow-xl overflow-hidden">
    <!-- Header -->
    <div class="bg-gradient-to-r from-blue-600 to-blue-800 p-8 text-white text-center">
      <h1 class="text-3xl font-bold">الملف الشخصي</h1>
      <p class="mt-2 text-blue-100">عدل بياناتك وصورة حسابك</p>
    </div>

    <!-- Content -->
    <div class="p-6 sm:p-8">
      <!-- Loading -->
      <div *ngIf="loading" class="flex justify-center py-12">
        <div class="w-12 h-12 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"></div>
      </div>

      <!-- Profile Card -->
      <div *ngIf="!loading" class="space-y-8">
        <!-- Profile Image -->
        <div class="flex flex-col items-center">
          <div class="relative">
            <div class="w-32 h-32 rounded-full overflow-hidden border-6 border-white shadow-2xl">
              <img
                [src]="previewUrl ? (previewUrl + '?t=' + getTimestamp()) : 'https://ui-avatars.com/api/?name=' + (user.name || 'م') + '&background=3b82f6&color=fff&size=150&bold=true&font-size=0.33'"
                alt="صورة الملف الشخصي"
                class="w-full h-full object-cover">
            </div>

            <!-- Change Photo Button -->
            <label class="absolute bottom-0 right-0 bg-blue-600 hover:bg-blue-700 rounded-full p-3 cursor-pointer shadow-xl transition">
              <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"></path>
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M15 13a3 3 0 11-6 0 3 3 0 016 0z"></path>
              </svg>
              <input
                type="file"
                class="hidden"
                accept="image/*"
                (change)="onFileSelected($event)"
                [disabled]="!isEditing">
            </label>
          </div>

          <h2 class="text-2xl font-bold mt-6">{{ user.name }}</h2>
          <p class="text-gray-600 text-lg">
            {{ user.role === 'job_seeker' ? 'باحث عن عمل' : 'صاحب عمل' }}
          </p>
        </div>

        <!-- Form Fields -->
        <div class="space-y-6">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">الاسم الكامل</label>
            <input
              [(ngModel)]="user.name"
              [disabled]="!isEditing"
              class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-50 disabled:text-gray-500 transition"
              placeholder="اسمك الكامل">
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">البريد الإلكتروني</label>
            <input
              [value]="user.email"
              disabled
              class="w-full px-4 py-3 border border-gray-300 rounded-xl bg-gray-50 text-gray-600">
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">رقم الهاتف (اختياري)</label>
            <input
              [(ngModel)]="user.phone"
              [disabled]="!isEditing"
              class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-50 disabled:text-gray-500 transition"
              placeholder="مثال: 0123456789">
          </div>
        </div>

        <!-- Action Buttons -->
        <div class="flex flex-col sm:flex-row gap-4 justify-center mt-10">
          <button
            *ngIf="!isEditing"
            (click)="toggleEdit()"
            class="w-full sm:w-auto px-10 py-4 bg-blue-600 hover:bg-blue-700 text-white text-lg font-semibold rounded-xl shadow-lg hover:shadow-xl transition">
            تعديل البيانات
          </button>

          <div *ngIf="isEditing" class="flex flex-col sm:flex-row gap-4 w-full">
            <button
              (click)="saveProfile()"
              [disabled]="saving"
              class="flex-1 px-10 py-4 bg-green-600 hover:bg-green-700 text-white text-lg font-semibold rounded-xl shadow-lg hover:shadow-xl transition disabled:opacity-70">
              {{ saving ? 'جاري الحفظ...' : 'حفظ التغييرات' }}
            </button>

            <button
              (click)="cancelEdit()"
              class="flex-1 px-10 py-4 bg-gray-500 hover:bg-gray-600 text-white text-lg font-semibold rounded-xl shadow-lg hover:shadow-xl transition">
              إلغاء
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
