<div class="profile-container">
  <div class="profile-card">
    <!-- Header -->
    <div class="profile-header">
      <h1>الملف الشخصي</h1>
      <p>إدارة بياناتك الشخصية بسهولة وأمان</p>
    </div>
    <!-- Content -->
    <div class="profile-content">
      <!-- Loading -->
      <div *ngIf="loading" class="loading-spinner">
        <div class="spinner"></div>
      </div>

      <!-- Main Content -->
      <div *ngIf="!loading">
        <!-- Toast Notification -->
        <div
          *ngIf="message"
          class="profile-toast"
          [class.profile-toast-success]="message.type === 'success'"
          [class.profile-toast-error]="message.type === 'error'"
        >
          {{ message.text }}
        </div>

        <!-- Avatar -->
        <div class="profile-avatar-wrapper">
          <div class="avatar-container">
            <img
              [src]="previewUrl || user?.profileImage || 'assets/default-profile.png'"
              alt="صورة الملف الشخصي لـ {{ user.name || 'المستخدم' }}"
              class="profile-avatar"
              loading="lazy"
              (error)="previewUrl = 'assets/default-profile.png'; user.profileImage = 'assets/default-profile.png'"
            >
            <label *ngIf="isEditing" class="profile-camera-btn cursor-pointer">
              <i class="fas fa-camera"></i>
              <input
                type="file"
                accept="image/*"
                (change)="onFileSelected($event)"
                class="hidden"
              >
            </label>
          </div>

          <h2 class="profile-name">
            {{ user.name || 'المستخدم' }}
          </h2>

          <!-- نوع الحساب بدون أيقونة -->
          <p class="profile-role">
            {{ user.role === 'job_seeker' ? 'باحث عن عمل' : 'صاحب عمل' }}
          </p>

          <p class="profile-email">
            <i class="fas fa-envelope"></i> {{ user.email }}
          </p>
        </div>

        <!-- Info Card -->
        <div class="profile-info-card">
          <h3 class="profile-info-title">
            <i class="fas fa-info-circle"></i>
            معلومات الحساب
          </h3>

          <div class="profile-form-grid">
            <!-- الاسم الكامل -->
            <div>
              <label for="name" class="profile-label">
                الاسم الكامل <span class="text-red-500">*</span>
              </label>
              <input
                id="name"
                name="name"
                [(ngModel)]="user.name"
                [disabled]="!isEditing"
                class="profile-input"
                required
                placeholder="أدخل اسمك الكامل"
              >
            </div>

            <!-- رقم الهاتف -->
            <div>
              <label for="phone" class="profile-label">
                رقم الهاتف (اختياري)
              </label>
              <input
                id="phone"
                name="phone"
                [(ngModel)]="user.phone"
                [disabled]="!isEditing"
                class="profile-input"
                placeholder="01xxxxxxxxx"
              >
            </div>

            <!-- النبذة -->
            <div class="col-span-full">
              <label for="bio" class="profile-label">
                نبذة تعريفية (اختياري)
              </label>
              <textarea
                id="bio"
                name="bio"
                [(ngModel)]="user.bio"
                [disabled]="!isEditing"
                rows="6"
                class="profile-input profile-textarea"
                placeholder="اكتب نبذة قصيرة عن نفسك..."
              ></textarea>
            </div>
          </div>
        </div>

        <!-- Action Buttons -->
        <div class="profile-actions">
          <button
            *ngIf="!isEditing"
            (click)="toggleEdit()"
            class="profile-btn profile-btn-edit"
          >
            <i class="fas fa-edit"></i>
            تعديل الملف الشخصي
          </button>

          <div *ngIf="isEditing" class="editing-buttons">
            <button
              (click)="saveProfile()"
              [disabled]="saving || !user.name?.trim()"
              class="profile-btn profile-btn-save"
            >
              <i class="fas fa-save" *ngIf="!saving"></i>
              <span *ngIf="saving" class="saving-text">
                <span class="spinner-small"></span>
                جاري الحفظ...
              </span>
              <span *ngIf="!saving">حفظ التغييرات</span>
            </button>

            <button
              (click)="cancelEdit()"
              class="profile-btn profile-btn-cancel"
            >
              <i class="fas fa-times"></i>
              إلغاء
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
